services:
  mongoDB:
    image: mongo:4.4.6
    container_name: rnapdbee-mongoDB-container
    environment:
      # Username and password can not be changed after volume creation, saved in volume!
      - MONGO_INITDB_ROOT_USERNAME=rnapdbee
      - MONGO_INITDB_ROOT_PASSWORD=Xdy0s3XvTLBxACdJrAfb
    volumes:
      - rnapdbee-mongoDB-volume:/data/db
    restart: on-failure

  adapters:
    build: ./rnapdbee-adapters
    container_name: rnapdbee-adapters-container
    restart: on-failure

  backend:
    build: ./rnapdbee-backend
    container_name: rnapdbee-backend-container
    depends_on:
      - mongoDB
    environment:
      - spring_data_mongodb_authentication-database=admin
      - spring_data_mongodb_username=rnapdbee
      - spring_data_mongodb_password=Xdy0s3XvTLBxACdJrAfb
      - spring_data_mongodb_database=backend-db
      - spring_data_mongodb_port=27017
      - spring_data_mongodb_host=rnapdbee-mongoDB-container
      - rnapdbee_engine_global_host=http://rnapdbee-engine-container:8081/calculation-api/
      - document_storage_days=14
      - svg_images_directory_path=/images
    volumes:
      - rnapdbee-backend-volume:/images
    restart: on-failure

  engine:
    build: ./rnapdbee-engine
    container_name: rnapdbee-engine-container
    restart: on-failure

  frontend:
    container_name: rnapdbee-frontend-container
    restart: on-failure

volumes:
  rnapdbee-mongoDB-volume:
  rnapdbee-backend-volume:
